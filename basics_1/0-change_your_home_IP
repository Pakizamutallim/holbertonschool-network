#!/usr/bin/env bash
# This script modifies the /etc/hosts file to change localhost IP

# Ensure the script is run as root
if [ "$(id -u)" -ne 0 ]; then
    echo "Please run as root"
    exit 1
fi 

# Backup the original /etc/hosts file
cp /etc/hosts /etc/hosts.backup

# Use a temporary file to build the new /etc/hosts content
temp_file=$(mktemp)

# Write all non-matching lines to the temporary file
while IFS= read -r line; do
    if [[ "$line" =~ ^127\.0\.0\.1 ]]; then
        continue
    elif [[ "$line" =~ facebook\.com ]]; then
        continue
    fi
    echo "$line" >> "$temp_file"
done < /etc/hosts

# Add the new entries
echo "127.0.0.2 localhost" >> "$temp_file"
echo "8.8.8.8 facebook.com" >> "$temp_file"

# Move the updated temp file to /etc/hosts
mv "$temp_file" /etc/hosts

echo "Hosts file updated successfully."
