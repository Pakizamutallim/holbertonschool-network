#!/usr/bin/env bash
# This script modifies the /etc/hosts file to change localhost IP

# Ensure the script is run as root
if [ "$(id -u)" -ne 0 ]; then
    echo "Please run as root"
    exit 1
fi 

# Backup the original /etc/hosts file
cp /etc/hosts /etc/hosts.backup

# Create a temporary file
temp_file=$(mktemp)

# Process /etc/hosts and modify entries
while IFS= read -r line; do
    # Exclude the lines that need to be updated
    if [[ $line =~ ^127\.0\.0\.1\s+localhost ]]; then
        echo "127.0.0.2 localhost" >> "$temp_file"
    elif [[ $line =~ facebook\.com ]]; then
        # Skip facebook.com lines
        continue
    else
        echo "$line" >> "$temp_file"
    fi
done < /etc/hosts

# Add the new facebook.com entry
echo "8.8.8.8 facebook.com" >> "$temp_file"

# Replace the original /etc/hosts with the updated one
mv "$temp_file" /etc/hosts

echo "Hosts file updated successfully."
